<h1>Ofexport Command:</h1>

<h2>Overview:</h2>

<p><strong>ofexport</strong> is a command line utility that reads the OmniFocus database. It's a work in progress but currently it's capabilities include:-</p>

<p>Exports it to a number of text based file formats:</p>

<ul>
<li>Taskpaper</li>
<li>Text</li>
<li>Markdown</li>
<li>OPML</li>
<li>HTML</li>
</ul>

<p>Filter what gets exported:</p>

<ul>
<li>Include/exclude tasks, projects, contexts and folders with text searches (regular expressions)</li>
<li>Include/exclude tasks and projects by completion date (regular expressions and "human" ones)</li>
</ul>

<p>Perform some restructuring of the data:</p>

<ul>
<li>Flatten the outport document to create a simpler document (just projects containing tasks)</li>
<li>Sort by various criteria</li>
</ul>

<h2>Installation:</h2>

<ul>
<li>Write this ("it's just python") @todo</li>
</ul>

<h2>Tutorial:</h2>

<p>To get help on usage and the full list of options ,run the command with no arguments:-</p>

<pre><code>    ofexport
</code></pre>

<p>A simple example of usage is:-</p>

<pre><code>    ofexport -o report.txt
</code></pre>

<p>This produces a not particularly useful text file (report.txt) of your entire task database.</p>

<p>To get useful data out we want to start using more structured formats and filters.</p>

<h3>File Formats:</h3>

<p>The format of the report file is controlled by the suffix of the output file. So by running:-</p>

<pre><code>    ofexport -o report.txt
</code></pre>

<p>you'll get a text file. By changing the suffix you'll get different formats:-
- .txt or .text: a simple text file
- .md or .markdown: a Markdown file
- .ft or .foldingtext: a Folding Text document (the same as .md)
- .tp or .taskpaper: a taskpaper document
- .opml: an OPML document
- .html or .htm: an HTML document            </p>

<h3>Filters:</h3>

<p>Filters are a powerful way of controlling the content or structure of your report. A minimal useful example is:-</p>

<pre><code>    ofexport -o report.tp --open --tci 'this week' --prune
</code></pre>

<p>This exports everything you've completed this week to a taskpaper document (report.tp) and opens it. The --tci and --prune options are both examples of filters.</p>

<p>In this case, the --tci filter (task completion include) includes only those tasks that were completed this week, eliminating all others. The resultant document would probably have a lot of empty folders and projects in it (because so many tasks have been filtered out). The  --prune filter eliminates any and all projects and folders that contain no tasks. The resultant document should be a pretty readable summary of what you've completed this week.</p>

<p>The core filters are:-</p>

<p><strong>Projects</strong></p>

<pre><code>    --pi regexp: include projects matching regexp
    --pe regexp: exclude projects matching regexp
    --psi regexp: include projects with start matching regexp
    --pse regexp: exclude projects with start matching regexp
    --pci regexp: include projects with completion matching regexp
    --pce regexp: exclude projects with completion matching regexp
    --pdi regexp: include projects with due matching regexp
    --pde regexp: exclude projects with due matching regexp
    --pfi: include flagged projects
    --pfe: exclude flagged projects
</code></pre>

<p><strong>Tasks</strong></p>

<pre><code>    --ti regexp: include tasks matching regexp
    --te regexp: exclude tasks matching regexp
    --tsi regexp: include tasks with start matching regexp
    --tse regexp: exclude tasks with start matching regexp
    --tdi regexp: include tasks with due matching regexp
    --tde regexp: exclude tasks with due matching regexp
    --tci regexp: include tasks with completion matching regexp
    --tce regexp: exclude tasks with completion matching regexp
    --tfi: include flagged tasks
    --tfe: exclude flagged tasks
    --tsc: sort tasks by completion
</code></pre>

<p><strong>Folders</strong></p>

<pre><code>    --fi regexp: include folders matching regexp
    --fe regexp: exclude folders matching regexp
</code></pre>

<p><strong>Contexts</strong></p>

<pre><code>    --ci regexp: include contexts matching regexp
    --ce regexp: exclude contexts matching regexp
</code></pre>

<p><strong>Misc</strong></p>

<pre><code>    -F: flatten project/task structure
</code></pre>

<p>The important thing to note about filters is that you can specify as many as you like and they are executed in the order you specify.</p>

<p>It's possible to create quite sophisticated queries on your OmniFocus database by using a series of queries and regular expressions but even without an in-depth knowledge of what a regular expression is it's possible to achieve white a lot.</p>

<p>Filters respect the tree structure of the tasks in your OmniFocus database. Filters are applied to all the items (folders, tasks, projects or contexts) in your database. When the filter is applied to an item, if it matches then it and all it's descendent's will appear in the output report. If the match fails on an item then that item (and all it's descendants) are eliminated from the output report.</p>

<p>If there are multiple filters then the output of one is passed to the next and so on.</p>

<p>Most of the filters come in two flavours, include and exclude with one being the inverse of the other.</p>

<h3>Filtering on Dates:</h3>

<p>The core date format is YYYY-MM-DD (sorry America) largely because Taskpaper requires this format so that sorting works (I may provide configuration in the future).</p>

<p>A week is considered to start on Monday.</p>

<p>A specific day can be expressed as:</p>

<ul>
<li>"Monday" - the monday that occurs within this week.</li>
<li>"th" - Days of the week can be abbreviated down to 2 characters.</li>
<li>"yesterday", "today",  "tomorrow"</li>
<li>"last tuesday" - the Tuesday that occurs in the previous week.</li>
<li>"next sat" - the Saturday that occurs in the next week.</li>
<li>"2013-04-09"</li>
</ul>

<p>A range of dates can be expressed as:</p>

<ul>
<li>"July", "jul" - every day in July of this year.</li>
<li>"to 2013-05-10" - everything on or before the date.</li>
<li>"from yesterday" - everything on or after yesterday.</li>
<li>"yesterday to 2014-10-01" everything between the two days</li>
<li>"this week" - everything from this Monday to this Sunday.</li>
<li>"next week"</li>
<li>"last week"</li>
<li>"none" or "" - only matches items with no date</li>
<li>"any" - only matches items with a date</li>
</ul>

<h3>Examples:</h3>

<p>This produces a document containing all tasks completed today from any folder with "Work" in it's title:-</p>

<pre><code>    ofexport -o report.tp --fi Work --tci 'today' --prune --open
</code></pre>

<p>This uses a little regular expression magic to create a document containing all tasks completed today from any folder with the exact name "Work":-</p>

<pre><code>    ofexport -o report.tp --fi '^Work$' --tci 'today' --prune --open
</code></pre>

<p>This produces a document containing all tasks completed today from any folder that does NOT have "Work" in it's title:-</p>

<pre><code>    ofexport -o report.tp --fe Work --tci 'today' --prune --open
</code></pre>

<p>This uses a little regular expression magic to create a document containing all tasks completed today from any folder with the exact name "Work" or "Home".</p>

<pre><code>    ofexport -o report.tp --fi '^Work$|^Home$' --tci 'today' --prune --open
</code></pre>

<p>This produces a document containing all tasks completed today from any folder with "Work" in it's title and the flattens/simplifies the indenting:-</p>

<pre><code>    ofexport -o report.tp --fi Work --tci 'today' --prune -F --open
</code></pre>

<p>This produces a report showing all tasks that contain "Beth" and their enclosing projects:-</p>

<pre><code>    ofexport -o report.tp --ti 'Beth' --prune --open -F
</code></pre>

<p>This produces the report of what I have yet to do on this project           </p>

<pre><code>    ofexport -o TODO.md --open --pi 'OmniPythonLib Todo' -F
</code></pre>
